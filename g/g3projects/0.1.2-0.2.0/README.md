# Comparing `tmp/g3projects-0.1.2.tar.gz` & `tmp/g3projects-0.2.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "g3projects-0.1.2.tar", last modified: Tue Feb  6 18:51:23 2024, max compression
+gzip compressed data, was "g3projects-0.2.0.tar", last modified: Mon Apr 29 13:37:57 2024, max compression
```

## Comparing `g3projects-0.1.2.tar` & `g3projects-0.2.0.tar`

### file list

```diff
@@ -1,48 +1,48 @@
-drwxrwxrwx   0        0        0        0 2024-02-06 18:51:23.049613 g3projects-0.1.2/
--rw-rw-rw-   0        0        0     1091 2023-06-02 14:34:32.000000 g3projects-0.1.2/LICENCE
--rw-rw-rw-   0        0        0      849 2024-02-06 18:51:23.049613 g3projects-0.1.2/PKG-INFO
--rw-rw-rw-   0        0        0      247 2024-02-06 18:31:48.000000 g3projects-0.1.2/README.md
--rw-rw-rw-   0        0        0      923 2024-02-06 18:50:16.000000 g3projects-0.1.2/pyproject.toml
--rw-rw-rw-   0        0        0       42 2024-02-06 18:51:23.049613 g3projects-0.1.2/setup.cfg
-drwxrwxrwx   0        0        0        0 2024-02-06 18:51:22.878079 g3projects-0.1.2/src/
-drwxrwxrwx   0        0        0        0 2024-02-06 18:51:22.919204 g3projects-0.1.2/src/g3projects/
--rw-rw-rw-   0        0        0       50 2024-01-29 13:49:44.000000 g3projects-0.1.2/src/g3projects/__init__.py
-drwxrwxrwx   0        0        0        0 2024-02-06 18:51:22.945740 g3projects-0.1.2/src/g3projects/logical/
--rw-rw-rw-   0        0        0       88 2024-01-29 22:17:08.000000 g3projects-0.1.2/src/g3projects/logical/__init__.py
--rw-rw-rw-   0        0        0    15317 2024-02-06 18:05:53.000000 g3projects-0.1.2/src/g3projects/logical/_logical.py
-drwxrwxrwx   0        0        0        0 2024-02-06 18:51:22.987339 g3projects-0.1.2/src/g3projects/logical/templates/
--rw-rw-rw-   0        0        0      362 2024-01-29 15:01:20.000000 g3projects-0.1.2/src/g3projects/logical/templates/ansic_prg.tpl
--rw-rw-rw-   0        0        0      448 2024-01-31 10:37:05.000000 g3projects-0.1.2/src/g3projects/logical/templates/autogenerated_block.tpl
--rw-rw-rw-   0        0        0      324 2024-01-29 13:43:27.000000 g3projects-0.1.2/src/g3projects/logical/templates/config_txt.tpl
--rw-rw-rw-   0        0        0      547 2024-01-31 10:35:27.000000 g3projects-0.1.2/src/g3projects/logical/templates/main_c.tpl
--rw-rw-rw-   0        0        0      736 2024-01-29 23:43:29.000000 g3projects-0.1.2/src/g3projects/logical/templates/main_c_system.tpl
--rw-rw-rw-   0        0        0      417 2024-01-29 14:00:14.000000 g3projects-0.1.2/src/g3projects/logical/templates/package_pkg_logical.tpl
--rw-rw-rw-   0        0        0      433 2024-01-29 14:02:30.000000 g3projects-0.1.2/src/g3projects/logical/templates/package_pkg_project.tpl
--rw-rw-rw-   0        0        0      621 2024-01-29 23:31:32.000000 g3projects-0.1.2/src/g3projects/logical/templates/package_pkg_system.tpl
--rw-rw-rw-   0        0        0      186 2024-01-31 10:36:11.000000 g3projects-0.1.2/src/g3projects/logical/templates/variables_var.tpl
--rw-rw-rw-   0        0        0      272 2024-01-29 23:05:47.000000 g3projects-0.1.2/src/g3projects/logical/templates/variables_var_system.tpl
-drwxrwxrwx   0        0        0        0 2024-02-06 18:51:23.002977 g3projects-0.1.2/src/g3projects/main/
--rw-rw-rw-   0        0        0       85 2024-02-06 18:25:59.000000 g3projects-0.1.2/src/g3projects/main/__init__.py
--rw-rw-rw-   0        0        0      843 2024-02-06 18:43:09.000000 g3projects-0.1.2/src/g3projects/main/_main.py
-drwxrwxrwx   0        0        0        0 2024-02-06 18:51:23.007786 g3projects-0.1.2/src/g3projects/physical/
--rw-rw-rw-   0        0        0       91 2024-01-31 10:13:41.000000 g3projects-0.1.2/src/g3projects/physical/__init__.py
--rw-rw-rw-   0        0        0     8429 2024-02-06 18:07:08.000000 g3projects-0.1.2/src/g3projects/physical/_physical.py
-drwxrwxrwx   0        0        0        0 2024-02-06 18:51:23.028286 g3projects-0.1.2/src/g3projects/physical/templates/
--rw-rw-rw-   0        0        0      654 2024-02-05 10:49:09.000000 g3projects-0.1.2/src/g3projects/physical/templates/config_pkg.tpl
--rw-rw-rw-   0        0        0      765 2024-02-05 10:48:56.000000 g3projects-0.1.2/src/g3projects/physical/templates/config_sfdomain.tpl
--rw-rw-rw-   0        0        0     2081 2024-02-05 10:49:33.000000 g3projects-0.1.2/src/g3projects/physical/templates/cpu_pkg.tpl
--rw-rw-rw-   0        0        0      288 2024-02-05 10:49:51.000000 g3projects-0.1.2/src/g3projects/physical/templates/hardware_hw.tpl
--rw-rw-rw-   0        0        0      183 2024-02-05 11:00:27.000000 g3projects-0.1.2/src/g3projects/physical/templates/iomap_iom.tpl
--rw-rw-rw-   0        0        0      436 2024-02-05 10:50:47.000000 g3projects-0.1.2/src/g3projects/physical/templates/physical_pkg.tpl
--rw-rw-rw-   0        0        0     1176 2024-02-05 10:51:02.000000 g3projects-0.1.2/src/g3projects/physical/templates/zone_sw.tpl
--rw-rw-rw-   0        0        0        0 2023-09-26 20:40:57.000000 g3projects-0.1.2/src/g3projects/py.typed
-drwxrwxrwx   0        0        0        0 2024-02-06 18:51:23.043922 g3projects-0.1.2/src/g3projects/utils/
--rw-rw-rw-   0        0        0      238 2024-01-29 21:47:36.000000 g3projects-0.1.2/src/g3projects/utils/__init__.py
--rw-rw-rw-   0        0        0     1274 2024-01-29 18:42:03.000000 g3projects-0.1.2/src/g3projects/utils/_utils.py
-drwxrwxrwx   0        0        0        0 2024-02-06 18:51:23.043922 g3projects-0.1.2/src/g3projects.egg-info/
--rw-rw-rw-   0        0        0      849 2024-02-06 18:51:22.000000 g3projects-0.1.2/src/g3projects.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0     1451 2024-02-06 18:51:22.000000 g3projects-0.1.2/src/g3projects.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2024-02-06 18:51:22.000000 g3projects-0.1.2/src/g3projects.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0       59 2024-02-06 18:51:22.000000 g3projects-0.1.2/src/g3projects.egg-info/entry_points.txt
--rw-rw-rw-   0        0        0       36 2024-02-06 18:51:22.000000 g3projects-0.1.2/src/g3projects.egg-info/requires.txt
--rw-rw-rw-   0        0        0       11 2024-02-06 18:51:22.000000 g3projects-0.1.2/src/g3projects.egg-info/top_level.txt
+drwxrwxrwx   0        0        0        0 2024-04-29 13:37:57.141863 g3projects-0.2.0/
+-rw-rw-rw-   0        0        0     1091 2023-06-02 14:34:32.000000 g3projects-0.2.0/LICENCE
+-rw-rw-rw-   0        0        0      836 2024-04-29 13:37:57.135865 g3projects-0.2.0/PKG-INFO
+-rw-rw-rw-   0        0        0      247 2024-02-06 18:31:48.000000 g3projects-0.2.0/README.md
+-rw-rw-rw-   0        0        0      897 2024-04-29 13:37:04.000000 g3projects-0.2.0/pyproject.toml
+-rw-rw-rw-   0        0        0       42 2024-04-29 13:37:57.142863 g3projects-0.2.0/setup.cfg
+drwxrwxrwx   0        0        0        0 2024-04-29 13:37:56.508790 g3projects-0.2.0/src/
+drwxrwxrwx   0        0        0        0 2024-04-29 13:37:56.581529 g3projects-0.2.0/src/g3projects/
+-rw-rw-rw-   0        0        0       50 2024-01-29 13:49:44.000000 g3projects-0.2.0/src/g3projects/__init__.py
+drwxrwxrwx   0        0        0        0 2024-04-29 13:37:56.761047 g3projects-0.2.0/src/g3projects/logical/
+-rw-rw-rw-   0        0        0       88 2024-01-29 22:17:08.000000 g3projects-0.2.0/src/g3projects/logical/__init__.py
+-rw-rw-rw-   0        0        0    18248 2024-04-22 13:14:00.000000 g3projects-0.2.0/src/g3projects/logical/_logical.py
+drwxrwxrwx   0        0        0        0 2024-04-29 13:37:56.885016 g3projects-0.2.0/src/g3projects/logical/templates/
+-rw-rw-rw-   0        0        0      360 2024-04-20 10:14:49.000000 g3projects-0.2.0/src/g3projects/logical/templates/ansic_prg.tpl
+-rw-rw-rw-   0        0        0      448 2024-01-31 10:37:05.000000 g3projects-0.2.0/src/g3projects/logical/templates/autogenerated_block.tpl
+-rw-rw-rw-   0        0        0      324 2024-01-29 13:43:27.000000 g3projects-0.2.0/src/g3projects/logical/templates/config_txt.tpl
+-rw-rw-rw-   0        0        0      547 2024-01-31 10:35:27.000000 g3projects-0.2.0/src/g3projects/logical/templates/main_c.tpl
+-rw-rw-rw-   0        0        0      736 2024-01-29 23:43:29.000000 g3projects-0.2.0/src/g3projects/logical/templates/main_c_system.tpl
+-rw-rw-rw-   0        0        0      400 2024-04-20 10:14:49.000000 g3projects-0.2.0/src/g3projects/logical/templates/package_pkg_logical.tpl
+-rw-rw-rw-   0        0        0      366 2024-04-20 10:14:49.000000 g3projects-0.2.0/src/g3projects/logical/templates/package_pkg_project.tpl
+-rw-rw-rw-   0        0        0      513 2024-04-20 10:14:49.000000 g3projects-0.2.0/src/g3projects/logical/templates/package_pkg_system.tpl
+-rw-rw-rw-   0        0        0      186 2024-01-31 10:36:11.000000 g3projects-0.2.0/src/g3projects/logical/templates/variables_var.tpl
+-rw-rw-rw-   0        0        0      272 2024-01-29 23:05:47.000000 g3projects-0.2.0/src/g3projects/logical/templates/variables_var_system.tpl
+drwxrwxrwx   0        0        0        0 2024-04-29 13:37:56.902466 g3projects-0.2.0/src/g3projects/main/
+-rw-rw-rw-   0        0        0       85 2024-02-06 18:25:59.000000 g3projects-0.2.0/src/g3projects/main/__init__.py
+-rw-rw-rw-   0        0        0     2696 2024-04-20 10:14:52.000000 g3projects-0.2.0/src/g3projects/main/_main.py
+drwxrwxrwx   0        0        0        0 2024-04-29 13:37:56.921662 g3projects-0.2.0/src/g3projects/physical/
+-rw-rw-rw-   0        0        0       91 2024-01-31 10:13:41.000000 g3projects-0.2.0/src/g3projects/physical/__init__.py
+-rw-rw-rw-   0        0        0     9033 2024-04-23 13:42:58.000000 g3projects-0.2.0/src/g3projects/physical/_physical.py
+drwxrwxrwx   0        0        0        0 2024-04-29 13:37:57.017112 g3projects-0.2.0/src/g3projects/physical/templates/
+-rw-rw-rw-   0        0        0      652 2024-04-20 10:14:49.000000 g3projects-0.2.0/src/g3projects/physical/templates/config_pkg.tpl
+-rw-rw-rw-   0        0        0      805 2024-04-20 10:14:49.000000 g3projects-0.2.0/src/g3projects/physical/templates/config_sfdomain.tpl
+-rw-rw-rw-   0        0        0     2094 2024-04-20 10:14:49.000000 g3projects-0.2.0/src/g3projects/physical/templates/cpu_pkg.tpl
+-rw-rw-rw-   0        0        0      270 2024-04-20 10:14:49.000000 g3projects-0.2.0/src/g3projects/physical/templates/hardware_hw.tpl
+-rw-rw-rw-   0        0        0      183 2024-02-05 11:00:27.000000 g3projects-0.2.0/src/g3projects/physical/templates/iomap_iom.tpl
+-rw-rw-rw-   0        0        0      436 2024-02-05 10:50:47.000000 g3projects-0.2.0/src/g3projects/physical/templates/physical_pkg.tpl
+-rw-rw-rw-   0        0        0     1176 2024-02-05 10:51:02.000000 g3projects-0.2.0/src/g3projects/physical/templates/zone_sw.tpl
+-rw-rw-rw-   0        0        0        0 2023-09-26 20:40:57.000000 g3projects-0.2.0/src/g3projects/py.typed
+drwxrwxrwx   0        0        0        0 2024-04-29 13:37:57.038114 g3projects-0.2.0/src/g3projects/utils/
+-rw-rw-rw-   0        0        0      238 2024-01-29 21:47:36.000000 g3projects-0.2.0/src/g3projects/utils/__init__.py
+-rw-rw-rw-   0        0        0      638 2024-04-20 10:14:52.000000 g3projects-0.2.0/src/g3projects/utils/_utils.py
+drwxrwxrwx   0        0        0        0 2024-04-29 13:37:57.131308 g3projects-0.2.0/src/g3projects.egg-info/
+-rw-rw-rw-   0        0        0      836 2024-04-29 13:37:56.000000 g3projects-0.2.0/src/g3projects.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0     1451 2024-04-29 13:37:56.000000 g3projects-0.2.0/src/g3projects.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2024-04-29 13:37:56.000000 g3projects-0.2.0/src/g3projects.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0       59 2024-04-29 13:37:56.000000 g3projects-0.2.0/src/g3projects.egg-info/entry_points.txt
+-rw-rw-rw-   0        0        0       45 2024-04-29 13:37:56.000000 g3projects-0.2.0/src/g3projects.egg-info/requires.txt
+-rw-rw-rw-   0        0        0       11 2024-04-29 13:37:56.000000 g3projects-0.2.0/src/g3projects.egg-info/top_level.txt
```

### Comparing `g3projects-0.1.2/LICENCE` & `g3projects-0.2.0/LICENCE`

 * *Files identical despite different names*

### Comparing `g3projects-0.1.2/PKG-INFO` & `g3projects-0.2.0/PKG-INFO`

 * *Files 14% similar despite different names*

```diff
@@ -1,23 +1,24 @@
 Metadata-Version: 2.1
 Name: g3projects
-Version: 0.1.2
+Version: 0.2.0
 Summary: System G3 Project PLC files generator
-Author-email: Konstantin Mykhailov <kmykhailov@elektroline.cz>
+Author: Elektroline a.s.
 Project-URL: Homepage, https://gitlab.elektroline.cz/plc/systemg3-py/SystemG3ProjectBuilder
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Operating System :: OS Independent
 Requires-Python: >=3.10
 Description-Content-Type: text/markdown
 License-File: LICENCE
 Requires-Dist: jinja2
 Requires-Dist: g3core
 Requires-Dist: g3elements
 Requires-Dist: g3hardware
+Requires-Dist: g3tables
 
 # System G3 Project PLC files generator
 
 ## Installation
 
 ```sh
 pip install g3projects
```

### Comparing `g3projects-0.1.2/pyproject.toml` & `g3projects-0.2.0/pyproject.toml`

 * *Files 14% similar despite different names*

```diff
@@ -1,27 +1,28 @@
 [project]
 name = "g3projects"
-version = "0.1.2"
+version = "0.2.0"
 description = "System G3 Project PLC files generator"
 readme = "README.md"
 license = {file = "LICENSE"}
 authors = [
-  { name = "Konstantin Mykhailov", email = "kmykhailov@elektroline.cz" },
+  { name="Elektroline a.s." },
 ]
 classifiers = [
     "Programming Language :: Python :: 3",
     "License :: OSI Approved :: MIT License",
     "Operating System :: OS Independent",
 ]
 requires-python = ">=3.10"
 dependencies = [
     "jinja2",
     "g3core",
     "g3elements",
-    "g3hardware"
+    "g3hardware",
+    "g3tables"
 ]
 
 [options]
 package_dir = {"" = "src"}
 
 [project.urls]
 "Homepage" = "https://gitlab.elektroline.cz/plc/systemg3-py/SystemG3ProjectBuilder"
```

### Comparing `g3projects-0.1.2/src/g3projects/logical/_logical.py` & `g3projects-0.2.0/src/g3projects/logical/_logical.py`

 * *Files 14% similar despite different names*

```diff
@@ -1,27 +1,30 @@
 import json
 import os
 import shutil
 import logging
+import typing
 
 from datetime import datetime
 from jinja2 import Environment, FileSystemLoader
 from textwrap import indent
 
 from g3core import G3Core
-from g3elements.config import SWSystemDictWrapper
-from g3elements.config.type_hinting import (
-    SystemDict, SWDeviceDict
-)
+from g3tables.system_config import SWSystemDictWrapper
+from g3tables.system_config.type_hinting import SystemDict, SWDeviceDict
+
 
 from ..utils import (
     format_template, combine_str, remove_multiple_newlines, write_to_file
 )
 
 
+logger = logging.getLogger('g3project_builder.logical')
+
+
 env = Environment(
     loader=FileSystemLoader(
         os.path.join(os.path.dirname(__file__), 'templates/')
         ),
     keep_trailing_newline=False,
     trim_blocks=True,
     )
@@ -32,16 +35,14 @@
     with open(path, 'r', encoding='utf-8') as file:
         return json.load(file)
 
 
 # ZONE #
 
 
-# ST Declarations - ! these ideally need to go to G3Core ! #
-
 def delete_config_keys_with_default_values(
     system_data: SWSystemDictWrapper, g3core: G3Core
 ) -> None:
     for *_, path, device_data in system_data.iter_devices_system():
         # find devType struct
         if not (dev_type := device_data.get('control', {}).get('devType')):
             print(device_data['general']['name'])
@@ -68,48 +69,59 @@
                         config_value is not None
                     ):
                         config_data_updated[config_key] = {
                             'value': config_value,
                             'dtype': member.dtype
                             }
                     else:
-                        info_msg = (
-                            f'Key "{config_key}" at "{path}/control/config" '
-                            f'contains default value of the "{member.name}" '
-                            f'member of the "{config_struct.name}" config '
-                            f'struct and will be ignored'
+                        logger.info(
+                            'Key "%s" at "%s/control/config" contains default '
+                            'value of the "%s" member of the "%s" config '
+                            'struct and will be ignored', config_key, path,
+                            member.name, config_struct.name
                             )
-                        logging.info(info_msg)
                     matched = True
                     break
             if not matched:
-                err_msg = (
-                    f'Key "{config_key}" at "{path}/control/config" '
-                    f'was not matched with any member of '
-                    f'the "{config_struct.name}" config struct '
-                    f'and will be ignored'
+                logger.warning(
+                    'Key "%s" at "%s/control/config" was not matched with any '
+                    'member of the "%s" config struct and will be ignored',
+                    config_key, path, config_struct.name
                     )
-                logging.warning(err_msg)
         config_data.clear()
         config_data.update(config_data_updated)
 
 
-def get_fb_declaration(device_data: SWDeviceDict) -> str:
-    varname = device_data['general']['varname']
-    fb_name = SWSystemDictWrapper.get_device_control_fb(device_data)
+# ST Declarations - ! these ideally need to go to G3Core ! #
+
+def get_fb_declaration(
+    device_data: SWDeviceDict,
+    device_domain: typing.Literal['control', 'test']
+) -> str:
+    if device_domain == 'control':
+        varname = device_data['general']['varname']
+        fb_name = SWSystemDictWrapper.get_device_control_fb(device_data)
+    elif device_domain == 'test':
+        varname = device_data['general']['varname_test']
+        fb_name = SWSystemDictWrapper.get_device_test_fb(device_data)
+    else:
+        raise ValueError(f'Invalid device domain: {device_domain}')
     if not fb_name:
-        name = device_data['general']['name']
-        logging.warning(
-            f'Could not generate function block declaration for {name}'
-        )
+        logger.warning(
+            'Could not generate function block declaration for %s',
+            device_data['general']['name']
+            )
         return ''
     return f'fb{varname} : {fb_name.strip()};'
 
 
-def get_dev_struct_declaration(device_data: SWDeviceDict) -> str:
+def get_dev_struct_declaration(
+    device_data: SWDeviceDict,
+    device_domain: typing.Literal['control', 'test']
+) -> str:
 
     def format_dict_recursive(d: dict):
         elements = []
         for key, value in d.items():
             if isinstance(value, dict):
                 value_str = format_dict_recursive(value)
                 elements.append(
@@ -125,15 +137,15 @@
 
     def format_value(value_data) -> str:
         try:
             dtype = value_data['dtype'].lower()
             value = value_data['value']
         except KeyError:
             name = device_data['general']['name']
-            logging.warning(f'Unable to format dev struct value at {name}')
+            logger.warning('Could not format dev struct value at %s', name)
             return ''
 
         if value is None:
             return ''
 
         if isinstance(value, dict):
             return format_dict_recursive(value)
@@ -152,59 +164,90 @@
         elif "int" in dtype or "word" in dtype:
             return str(int(value))
         elif "real" in dtype:
             return str(float(value))
         else:
             return str(value)
 
-    varname = device_data['general']['varname']
-    if not (dev_struct_type := device_data['control'].get('devType')):
+    if device_domain == 'control':
+        varname = device_data['general']['varname']
+        dev_struct_type = device_data['control'].get('devType')
+        config = device_data['control']['config']
+    elif device_domain == 'test':
+        varname = device_data['general']['varname_test']
+        dev_struct_type = device_data['test'].get('devType')
+        config = device_data['test']['config']
+    else:
+        raise ValueError(f'Invalid device domain: {device_domain}')
+    if not dev_struct_type:
         name = device_data['general']['name']
-        logging.warning(
-            f'Could not generate struct declaration for {name}'
-        )
+        logger.warning(
+            'Could not generate struct declaration for %s', name
+            )
         return ''
     config_values_formatted = []
-    for memb_name, memb_value_data in device_data['control']['config'].items():
+    for memb_name, memb_value_data in config.items():
         if (memb_value := format_value(memb_value_data)):
             config_values_formatted.append((memb_name, memb_value))
     config_vals = ", ".join(
         f'{memb_name} := {memb_value}'
         for memb_name, memb_value in config_values_formatted
         )
     if not config_vals:
         return f'{varname} : {dev_struct_type};'
     return f'{varname} : {dev_struct_type} := (config := ({config_vals}));'
 
 
-def get_fb_assignment(device_data: SWDeviceDict) -> str:
-    varname = device_data['general']['varname']
-    connected_fbs = device_data['control'].get('connector')
+def get_fb_assignment(
+    device_data: SWDeviceDict,
+    device_domain: typing.Literal['control', 'test']
+) -> str:
+    if device_domain == 'control':
+        varname = device_data['general']['varname']
+        connected_fbs = device_data['control'].get('connector')
+    elif device_domain == 'test':
+        varname_control = device_data['general']['varname']
+        varname = device_data['general']['varname_test']
+        connected_fbs = device_data['test'].get('connector')
+    else:
+        raise ValueError(f'Invalid device domain: {device_domain}')
     if not connected_fbs:
         return ""
     fb_assignment_lines = []
     for conn_name, conn_fb in connected_fbs.items():
         if conn_fb:
-            conn_fb_ptr = f"&{conn_fb}"
+            if device_domain == 'control':
+                conn_fb_ptr = f"&{conn_fb}"
+            else:  # varname_control is needed only for a test domain device
+                conn_fb_ptr = f"&fb{varname_control}.{conn_fb}"
         else:
-            logging.warning(f'Connector "{conn_name}" not set.')
+            logger.warning('Connector "%s" not set.', conn_name)
             conn_fb_ptr = "NULL"
         conn_assignment = f'fb{varname}.{conn_name} = {conn_fb_ptr};'
         fb_assignment_lines.append(conn_assignment)
     return '\n'.join(fb_assignment_lines)
 
 
-def get_fb_call(device_data: SWDeviceDict) -> str:
-    varname = device_data['general']['varname']
-    fb_name = SWSystemDictWrapper.get_device_control_fb(device_data)
+def get_fb_call(
+    device_data: SWDeviceDict,
+    device_domain: typing.Literal['control', 'test']
+) -> str:
+    if device_domain == 'control':
+        varname = device_data['general']['varname']
+        fb_name = SWSystemDictWrapper.get_device_control_fb(device_data)
+    elif device_domain == 'test':
+        varname = device_data['general']['varname_test']
+        fb_name = SWSystemDictWrapper.get_device_test_fb(device_data)
+    else:
+        raise ValueError(f'Invalid device domain: {device_domain}')
     if not fb_name:
         name = device_data['general']['name']
-        logging.warning(
-            f'Could not generate function block call for {name}'
-        )
+        logger.warning(
+            'Could not generate function block call for %s', name
+            )
         return ''
     return f'{fb_name}(&fb{varname});'
 
 
 def get_route_layout_declaration(device_data: SWDeviceDict) -> str:
     route_name = device_data['general']['varname']
     route_layout_data = device_data['general']['layout']
@@ -220,75 +263,92 @@
         declaration_lines.append(line)
     return "\n".join(declaration_lines)
 
 # ST Declarations  - END #
 
 
 def generate_zone_files_contents(
-    system_config: SWSystemDictWrapper, zone_name: str
+    system_config: SWSystemDictWrapper, zone_name: str, gen_test: bool = False
 ) -> tuple[str, str]:
     varibales_var = ''
     main_c = ''
     for _, path, device_data in system_config.iter_devices_zone(zone_name):
         if not system_config.get_device_control_fb(device_data):
-            logging.warning('function block type is missing for "%s"', path)
+            logger.warning('function block type is missing for "%s"', path)
             continue
         varibales_var = combine_str(
             varibales_var,
-            get_fb_declaration(device_data),
-            get_dev_struct_declaration(device_data),
+            get_fb_declaration(device_data, 'control'),
+            get_dev_struct_declaration(device_data, 'control'),
             )
         main_c = combine_str(
             main_c,
-            get_fb_assignment(device_data),
-            get_fb_call(device_data),
+            get_fb_assignment(device_data, 'control'),
+            get_fb_call(device_data, 'control'),
             )
-        if (
-            'Route' in path and
-            'NonSafety' in device_data['control'].get('function', '')
-        ):
+        if 'Route' in path:
+            route_fb = SWSystemDictWrapper.get_device_control_fb(device_data)
+            if route_fb and 'NonSafety' in route_fb:
+                main_c = combine_str(
+                    main_c,
+                    get_route_layout_declaration(device_data),
+                    )
+        if gen_test:
+            varibales_var = combine_str(
+                varibales_var,
+                get_fb_declaration(device_data, 'test'),
+                get_dev_struct_declaration(device_data, 'test'),
+                )
             main_c = combine_str(
                 main_c,
-                get_route_layout_declaration(device_data),
+                get_fb_assignment(device_data, 'test'),
+                get_fb_call(device_data, 'test'),
                 )
     return (
         indent(remove_multiple_newlines(varibales_var), '    '),
         indent(remove_multiple_newlines(main_c), '    ')
         )
 
-
 # ZONE END #
 
 
 # COMM #
 
-
 def generate_comm_files_contents(
-    system_config: SWSystemDictWrapper
+    system_config: SWSystemDictWrapper, gen_test: bool = False
 ) -> tuple[str, str]:
     varibales_var = ''
     main_c = ''
     for *_, device_data in system_config.iter_devices_zone('Common'):
         if device_data['general']['metatype'] != 'Comm':
             continue
         varibales_var = combine_str(
             varibales_var,
-            get_fb_declaration(device_data),
+            get_fb_declaration(device_data, 'control'),
             )
         main_c = combine_str(
             main_c,
-            get_fb_assignment(device_data),
-            get_fb_call(device_data),
+            get_fb_assignment(device_data, 'control'),
+            get_fb_call(device_data, 'control'),
             )
+        if gen_test:
+            varibales_var = combine_str(
+                varibales_var,
+                get_fb_declaration(device_data, 'test'),
+                )
+            main_c = combine_str(
+                main_c,
+                get_fb_assignment(device_data, 'test'),
+                get_fb_call(device_data, 'test'),
+                )
     return (
         indent(remove_multiple_newlines(varibales_var), '    '),
         indent(remove_multiple_newlines(main_c), '    ')
         )
 
-
 # COMM END #
 
 
 # SYSTEM #
 
 def generate_system_files_contents(
     system_config: SWSystemDictWrapper
@@ -307,24 +367,29 @@
 
 # SYSTEM END #
 
 
 # ZONE.VAR #
 
 def generate_zone_var_contents(
-    system_config: SWSystemDictWrapper
+    system_config: SWSystemDictWrapper, gen_test: bool = False
 ) -> str:
     zone_var = ''
     for *_, device_data in system_config.iter_devices_zone('Common'):
         if device_data['general']['metatype'] == 'Project':
             continue
         zone_var = combine_str(
             zone_var,
-            get_dev_struct_declaration(device_data),
+            get_dev_struct_declaration(device_data, 'control'),
             )
+        if gen_test:
+            zone_var = combine_str(
+                zone_var,
+                get_dev_struct_declaration(device_data, 'test'),
+                )
     return indent(remove_multiple_newlines(zone_var), '    ')
 
 
 # ZONE.VAR END #
 
 
 def makedirs_logical(
@@ -368,36 +433,40 @@
         folder_path,
         'ANSIC.prg',
         format_template(env, 'ansic_prg.tpl')
         )
     return folder_path
 
 
-def generate_logical_files(system_config_path: str) -> None:
+def generate_logical_files(
+    system_config_path: str, gen_test: bool = False
+) -> None:
     g3core = G3Core.from_local('./Logical/Libraries')
     system = get_system_dict(system_config_path)
     sw_system_wrapper = SWSystemDictWrapper(system['Software'])
     project_name = sw_system_wrapper.get_project_name()
     system_name = sw_system_wrapper.get_system_name()
     delete_config_keys_with_default_values(sw_system_wrapper, g3core)
     # create Zones folder files
     zone_tasknames: list[str] = []
     for zone_name in system['Software']:
         if zone_name == 'Common':
             continue
         varibales_var, main_c = generate_zone_files_contents(
-            sw_system_wrapper, zone_name
+            sw_system_wrapper, zone_name, gen_test
             )
         zone_taskname = sw_system_wrapper.get_zone_taskname(zone_name)
         zone_tasknames.append(zone_taskname)
         generate_main_variables_ansic_files(
             project_name, system_name, zone_taskname, main_c, varibales_var
             )
     # create Comm folder files
-    varibales_var, main_c = generate_comm_files_contents(sw_system_wrapper)
+    varibales_var, main_c = generate_comm_files_contents(
+        sw_system_wrapper, gen_test
+        )
     generate_main_variables_ansic_files(
         project_name, system_name, 'Comm', main_c, varibales_var
         )
     # create System folder files
     varibales_var, main_c = generate_system_files_contents(sw_system_wrapper)
     path = generate_main_variables_ansic_files(
         project_name, system_name, 'System', main_c, varibales_var
```

### Comparing `g3projects-0.1.2/src/g3projects/logical/templates/main_c.tpl` & `g3projects-0.2.0/src/g3projects/logical/templates/main_c.tpl`

 * *Files identical despite different names*

### Comparing `g3projects-0.1.2/src/g3projects/logical/templates/main_c_system.tpl` & `g3projects-0.2.0/src/g3projects/logical/templates/main_c_system.tpl`

 * *Files identical despite different names*

### Comparing `g3projects-0.1.2/src/g3projects/physical/_physical.py` & `g3projects-0.2.0/src/g3projects/physical/_physical.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,24 +1,27 @@
 import json
 import os
 import shutil
-# import logging
+import logging
 
 from datetime import datetime
 from jinja2 import Environment, FileSystemLoader
 from textwrap import indent
 
-from g3elements.config import SWSystemDictWrapper
-from g3elements.config.type_hinting import SystemDict
+from g3tables.system_config import SWSystemDictWrapper
+from g3tables.system_config.type_hinting import SystemDict
 
 from ..utils import (
     format_template, write_to_file
 )
 
-from g3hardware import HWModule, HWIsle
+from g3hardware import HardwareModule, HardwareIsle, format_type, is_cpu_type
+
+
+logger = logging.getLogger('g3project_builder.physical')
 
 
 env = Environment(
     loader=FileSystemLoader(
         os.path.join(os.path.dirname(__file__), 'templates/')
         ),
     keep_trailing_newline=False,
@@ -38,15 +41,15 @@
         'Physical',
         system_name
         )
     os.makedirs(os.path.join(path, 'CPU'), exist_ok=True)
     return path
 
 
-# TODO: Would be nice to moce to some kind of wrapper
+# TODO: Would be nice to move to some kind of wrapper
 
 def is_safety_configuration(config_hw: list[dict]) -> bool:
     for isle in config_hw:
         if 'SL8101' in isle['head']['type']:
             return True
     return False
 
@@ -55,71 +58,78 @@
     module_type_lower = module_type.lower()
     for isle in config_hw:
         if module_type_lower in isle['head']['type'].lower():
             head = isle['head']
             return f"{head['type']}_{head['cabinet']}_{head['name_suffix']}"
     raise ValueError(f'Module "{module_type}" data was not found')
 
+
+def get_cpu_module_name_default(module_name) -> str:
+    module_name_formatted = format_type(module_name)
+    if not is_cpu_type(module_name_formatted):
+        raise ValueError(f'Module "{module_name}" is not a CPU module')
+    return module_name_formatted
+
 # END TODO ##
 
 
 # Hardware.hw #
 
-def create_hw_isles(config_hw: dict) -> HWIsle | None:
-    isles: list[HWIsle] = []
+def create_hw_isles(config_hw: dict) -> HardwareIsle | None:
+    isles: list[HardwareIsle] = []
     for isle_data in config_hw:
         module_type = isle_data['head']['type']
         cabinet = isle_data['head']['cabinet']
         name_suffix = isle_data['head']['name_suffix']
-        head = HWModule.new(
-            module_type=module_type,
-            module_name_suffix=f"{cabinet}_{name_suffix}"
+        head = HardwareModule.new(
+            type_=module_type,
+            name_suffix=f"{cabinet}_{name_suffix}"
             )
         tail = []
         for module_data in isle_data['tail']:
             module_type = module_data['type']
             cabinet = module_data['cabinet']
             name_suffix = module_data['name_suffix']
-            module = HWModule.new(
-                module_type=module_type,
-                module_name_suffix=f"{cabinet}_{name_suffix}"
-            )
+            module = HardwareModule.new(
+                type_=module_type,
+                name_suffix=f"{cabinet}_{name_suffix}"
+                )
             tail.append(module)
-        isles.append(HWIsle(head, *tail))
+        isles.append(HardwareIsle(head, *tail))
     # move the CPU isle to the start of the isle list
-    cp1584_isle_i = -1
+    cpu_isle_i = -1
     for i, isle in enumerate(isles):
-        if isle.head.type == 'X20cCP1584':
-            cp1584_isle_i = i
+        if is_cpu_type(isle.head.type_):
+            cpu_isle_i = i
             break
-    if cp1584_isle_i == -1:
+    if cpu_isle_i == -1:
         raise ValueError(
-            "X20cCP1584 CPU module was not found in the hardware configuration"
+            "CPU module was not found in the hardware configuration"
             )
-    if cp1584_isle_i != 0:
-        isles.insert(0, isles.pop(cp1584_isle_i))
+    if cpu_isle_i != 0:
+        isles.insert(0, isles.pop(cpu_isle_i))
     # connect the isles
     for i, isle in enumerate(isles[:-1]):
         isle.next_isle = isles[i + 1]
     if not isles:
         return None
     return isles[0]
 
 
 def generate_hardware_hw_contents(
     config_hw: dict, system_name: str, cp1584_name: str
 ) -> str:
     if not (hw_isle := create_hw_isles(config_hw)):
         return ''
-    contents = hw_isle.to_xml_str()
+    contents = hw_isle.to_str()
     return contents.format(
         HOST_NAME=f'{system_name}_plc',
         PROJECT_ZONE=system_name,
         CP1584_NAME=cp1584_name
-    )
+        )
 
 # END Hardware.hw #
 
 
 # Iomap.iom #
 
 def generate_iomap_iom_contents(system: SWSystemDictWrapper) -> list[str]:
@@ -166,20 +176,27 @@
     # create Config.pkg file
     write_to_file(
         physical_path,
         'Config.pkg',
         format_template(env, 'config_pkg.tpl', cpu_type='CPU')
         )
     # create Hardware.hw and Hardware.hwl files
-    cpu_name = get_hardware_module_name(
-        'cp1584', system['Hardware']  # type: ignore
-        )
-    hardware_hw = generate_hardware_hw_contents(
-        system['Hardware'], system_name, cpu_name  # type: ignore
-        )
+    try:
+        cpu_name = get_hardware_module_name(
+            'cp1584', system['Hardware']  # type: ignore
+            )
+        hardware_hw = generate_hardware_hw_contents(
+            system['Hardware'], system_name, cpu_name  # type: ignore
+            )
+    except ValueError:
+        logger.warning(
+            'Hardware configuration does not contain a CPU module. '
+            'Hardware.hw file will not be generated.'
+            )
+        hardware_hw = ''
     write_to_file(
         physical_path,
         'Hardware.hw',
         format_template(env, 'hardware_hw.tpl', hardware=hardware_hw)
         )
     write_to_file(
         physical_path,
```

### Comparing `g3projects-0.1.2/src/g3projects/physical/templates/config_pkg.tpl` & `g3projects-0.2.0/src/g3projects/physical/templates/config_pkg.tpl`

 * *Files 4% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 {# templates/config_pkg.tpl #}
 
 <?xml version="1.0" encoding="utf-8"?>
-<?AutomationStudio Version=4.8.5.98 SP?>
+<?AutomationStudio FileVersion="4.9"?>
 <!--autogenerated {{ timestamp }}-->
 <Configuration xmlns="http://br-automation.co.at/AS/Configuration">
   <Objects>
     <Object Type="File" Description="Hardware configuration">Hardware.hw</Object>
     <Object Type="File" Description="Hardware configuration">Hardware.hwl</Object>
     <Object Type="Cpu">{{ cpu_type }}</Object>
     <Object Type="File">Hardware.jpg</Object>
```

### Comparing `g3projects-0.1.2/src/g3projects/physical/templates/config_sfdomain.tpl` & `g3projects-0.2.0/src/g3projects/physical/templates/config_sfdomain.tpl`

 * *Files 9% similar despite different names*

```diff
@@ -1,10 +1,11 @@
 {# templates/config_swdomain.tpl #}
 
 <?xml version="1.0" encoding="utf-8"?>
+<?AutomationStudio FileVersion="4.9"?>
 <!--autogenerated {{ timestamp }}-->
 <Configuration>
   <Element ID="gSafeDomain" Type="sfdomain">
     <Group ID="DefaultSettings">
       <Property ID="SafeDomain" Value="1" />
       <Property ID="SafeLOGICName" Value="{{ sl8101_name }}" />
       <Property ID="SafeLOGICProductId" Value="X20cSL8101" />
```

### Comparing `g3projects-0.1.2/src/g3projects/physical/templates/cpu_pkg.tpl` & `g3projects-0.2.0/src/g3projects/physical/templates/cpu_pkg.tpl`

 * *Files 11% similar despite different names*

```diff
@@ -11,19 +11,19 @@
     <Object Type="Package" Reference="true">\Physical\_resources\mappServices</Object>
     <Object Type="Package" Reference="true">\Physical\_resources\AccessAndSecurity</Object>
     {% if add_mapp_safety %}
     <Object Type="Package">mappSafety</Object>
     {% endif %}
   </Objects>
   <Configuration ModuleId="X20cCP1584">
-    <AutomationRuntime Version="C4.92"/>
-    <Build AdditionalBuildOptions="-D _HAS_GIT_VERSION" GccVersion="6.3.0" PreBuildStep="$(AS_PROJECT_PATH)/Scripts/as_build/prebuild.bat $(AS_PROJECT_PATH)"/>
+    <AutomationRuntime Version="F4.92"/>
+    <Build AdditionalBuildOptions="-D _HAS_GIT_VERSION" GccVersion="6.3.0" PreBuildStep="$(AS_PROJECT_PATH)/Scripts/as_build/prebuild.bat $(AS_PROJECT_PATH)" />
     <DefaultTargetMemory Tasks="UserROM"/>
     <Io Supervision="False"/>
     <Opc WindowsServer="False"/>
     <Safety SafetyRelease="0.0"/>
     <Transfer AddToUserPart="True" AdditionalUserDir="\Scripts\as_build\user_partition" AllowDowngrade="True" AllowInitialTransfer="False" AllowPartitioning="False" ExecuteInitExitProgram="True" ForceInitialTransfer="False" GenerateRUCPackage="True" IdentificationTypeValue="" IgnoreVersion="True" KeepNonVolatileMemory="False" PreserveVariableValues="False" ProjectConsistent="False" RebootDuringTransfer="True" SavedOfflineInstallationFolder="" SavedPipDestinationFolder="" SavedRuntimeUtilityCenterPackagePath="" TargetIdentificationType="Always" TryToBootInRunMode="False" UserFilesIgnoreDifference="False"/>
     <Vc FirmwareVersion=""/>
-    <OnlineConfiguration Name="PLC_XX" DeviceType="TCPIP" DeviceParameters="/IF=tcpip /LOPO=00000 /SA=0" ConnectionParameters="/COMT=0000 /RT=0000 /AM=* /SDT=0 /DAIP=0.0.0.0 /REPO=00000 /ANSL=0 /PT=0" Description=""/>
+    <OnlineConfiguration Name="PLC_Local" DeviceType="TCPIP" DeviceParameters="/IF=tcpip /LOPO=11159 /SA=1" ConnectionParameters="/COMT=2500 /RT=1000 /AM=* /SDT=5 /DAIP=192.168.1.10 /REPO=11169 /ANSL=1 /PT=11169" Description=""/>
   </Configuration>
 </Cpu>
 <!--end of autogenerated-->
```

### Comparing `g3projects-0.1.2/src/g3projects/physical/templates/zone_sw.tpl` & `g3projects-0.2.0/src/g3projects/physical/templates/zone_sw.tpl`

 * *Files identical despite different names*

### Comparing `g3projects-0.1.2/src/g3projects.egg-info/PKG-INFO` & `g3projects-0.2.0/src/g3projects.egg-info/PKG-INFO`

 * *Files 14% similar despite different names*

```diff
@@ -1,23 +1,24 @@
 Metadata-Version: 2.1
 Name: g3projects
-Version: 0.1.2
+Version: 0.2.0
 Summary: System G3 Project PLC files generator
-Author-email: Konstantin Mykhailov <kmykhailov@elektroline.cz>
+Author: Elektroline a.s.
 Project-URL: Homepage, https://gitlab.elektroline.cz/plc/systemg3-py/SystemG3ProjectBuilder
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Operating System :: OS Independent
 Requires-Python: >=3.10
 Description-Content-Type: text/markdown
 License-File: LICENCE
 Requires-Dist: jinja2
 Requires-Dist: g3core
 Requires-Dist: g3elements
 Requires-Dist: g3hardware
+Requires-Dist: g3tables
 
 # System G3 Project PLC files generator
 
 ## Installation
 
 ```sh
 pip install g3projects
```

### Comparing `g3projects-0.1.2/src/g3projects.egg-info/SOURCES.txt` & `g3projects-0.2.0/src/g3projects.egg-info/SOURCES.txt`

 * *Files identical despite different names*

