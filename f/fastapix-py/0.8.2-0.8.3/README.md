# Comparing `tmp/fastapix_py-0.8.2-py3-none-any.whl.zip` & `tmp/fastapix_py-0.8.3-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,23 +1,23 @@
-Zip file size: 2471747 bytes, number of entries: 39
+Zip file size: 2471779 bytes, number of entries: 39
 -rw-r--r--  2.0 unx      638 b- defN 20-Feb-02 00:00 fastapix/__init__.py
 -rw-r--r--  2.0 unx      196 b- defN 20-Feb-02 00:00 fastapix/__main__.py
 -rw-r--r--  2.0 unx      425 b- defN 20-Feb-02 00:00 fastapix/exceptions.py
 -rw-r--r--  2.0 unx     2321 b- defN 20-Feb-02 00:00 fastapix/handlers.py
 -rw-r--r--  2.0 unx      224 b- defN 20-Feb-02 00:00 fastapix/innerclient.py
 -rw-r--r--  2.0 unx    15404 b- defN 20-Feb-02 00:00 fastapix/main.py
 -rw-r--r--  2.0 unx     2198 b- defN 20-Feb-02 00:00 fastapix/responses.py
 -rw-r--r--  2.0 unx      134 b- defN 20-Feb-02 00:00 fastapix/common/__init__.py
 -rw-r--r--  2.0 unx      797 b- defN 20-Feb-02 00:00 fastapix/common/json.py
 -rw-r--r--  2.0 unx    18913 b- defN 20-Feb-02 00:00 fastapix/common/pydantic.py
 -rw-r--r--  2.0 unx      301 b- defN 20-Feb-02 00:00 fastapix/crud/__init__.py
 -rw-r--r--  2.0 unx     9912 b- defN 20-Feb-02 00:00 fastapix/crud/_models.py
 -rw-r--r--  2.0 unx     8563 b- defN 20-Feb-02 00:00 fastapix/crud/_router.py
--rw-r--r--  2.0 unx    18757 b- defN 20-Feb-02 00:00 fastapix/crud/_selecter.py
--rw-r--r--  2.0 unx     8896 b- defN 20-Feb-02 00:00 fastapix/crud/_sqlalchemy.py
+-rw-r--r--  2.0 unx    18953 b- defN 20-Feb-02 00:00 fastapix/crud/_selecter.py
+-rw-r--r--  2.0 unx     8919 b- defN 20-Feb-02 00:00 fastapix/crud/_sqlalchemy.py
 -rw-r--r--  2.0 unx    22466 b- defN 20-Feb-02 00:00 fastapix/crud/_sqlmodel.py
 -rw-r--r--  2.0 unx      532 b- defN 20-Feb-02 00:00 fastapix/crud/_sqltypes.py
 -rw-r--r--  2.0 unx      180 b- defN 20-Feb-02 00:00 fastapix/crud/mixins/__init__.py
 -rw-r--r--  2.0 unx      795 b- defN 20-Feb-02 00:00 fastapix/crud/mixins/_typing.py
 -rw-r--r--  2.0 unx     1706 b- defN 20-Feb-02 00:00 fastapix/crud/mixins/models.py
 -rw-r--r--  2.0 unx     1248 b- defN 20-Feb-02 00:00 fastapix/logging/__init__.py
 -rw-r--r--  2.0 unx      805 b- defN 20-Feb-02 00:00 fastapix/logging/handlers.py
@@ -30,12 +30,12 @@
 -rw-r--r--  2.0 unx   150947 b- defN 20-Feb-02 00:00 fastapix/offline/static/openapi/swagger-ui.css
 -rw-r--r--  2.0 unx   260489 b- defN 20-Feb-02 00:00 fastapix/offline/static/openapi/swagger-ui.css.map
 -rw-r--r--  2.0 unx      134 b- defN 20-Feb-02 00:00 fastapix/sso/__init__.py
 -rw-r--r--  2.0 unx     3168 b- defN 20-Feb-02 00:00 fastapix/sso/_client.py
 -rw-r--r--  2.0 unx     1297 b- defN 20-Feb-02 00:00 fastapix/sso/cas.py
 -rw-r--r--  2.0 unx      163 b- defN 20-Feb-02 00:00 fastapix/sso/extend/__init__.py
 -rw-r--r--  2.0 unx     1428 b- defN 20-Feb-02 00:00 fastapix/sso/extend/casdoor.py
-?rw-r--r--  2.0 unx     3907 b- defN 20-Feb-02 00:00 fastapix_py-0.8.2.dist-info/METADATA
-?rw-r--r--  2.0 unx       87 b- defN 20-Feb-02 00:00 fastapix_py-0.8.2.dist-info/WHEEL
-?rw-r--r--  2.0 unx    11558 b- defN 20-Feb-02 00:00 fastapix_py-0.8.2.dist-info/licenses/LICENSE
-?rw-r--r--  2.0 unx     3366 b- defN 20-Feb-02 00:00 fastapix_py-0.8.2.dist-info/RECORD
-39 files, 8846249 bytes uncompressed, 2466379 bytes compressed:  72.1%
+?rw-r--r--  2.0 unx     3907 b- defN 20-Feb-02 00:00 fastapix_py-0.8.3.dist-info/METADATA
+?rw-r--r--  2.0 unx       87 b- defN 20-Feb-02 00:00 fastapix_py-0.8.3.dist-info/WHEEL
+?rw-r--r--  2.0 unx    11558 b- defN 20-Feb-02 00:00 fastapix_py-0.8.3.dist-info/licenses/LICENSE
+?rw-r--r--  2.0 unx     3366 b- defN 20-Feb-02 00:00 fastapix_py-0.8.3.dist-info/RECORD
+39 files, 8846468 bytes uncompressed, 2466411 bytes compressed:  72.1%
```

## zipnote {}

```diff
@@ -99,20 +99,20 @@
 
 Filename: fastapix/sso/extend/__init__.py
 Comment: 
 
 Filename: fastapix/sso/extend/casdoor.py
 Comment: 
 
-Filename: fastapix_py-0.8.2.dist-info/METADATA
+Filename: fastapix_py-0.8.3.dist-info/METADATA
 Comment: 
 
-Filename: fastapix_py-0.8.2.dist-info/WHEEL
+Filename: fastapix_py-0.8.3.dist-info/WHEEL
 Comment: 
 
-Filename: fastapix_py-0.8.2.dist-info/licenses/LICENSE
+Filename: fastapix_py-0.8.3.dist-info/licenses/LICENSE
 Comment: 
 
-Filename: fastapix_py-0.8.2.dist-info/RECORD
+Filename: fastapix_py-0.8.3.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## fastapix/__init__.py

```diff
@@ -1,13 +1,13 @@
 # !/usr/bin/env Python3
 # -*- coding: utf-8 -*-
 # @Author   : zhangzhanqi
 # @FILE     : __init__.py
 # @Time     : 2023/11/16 16:37
-__version__ = "0.8.2"
+__version__ = "0.8.3"
 
 
 from fastapi import FastAPI
 
 from .main import run, main
```

## fastapix/crud/_selecter.py

```diff
@@ -91,15 +91,25 @@
 
 def _python_to_table_json(value):
     value = json_validator(value)
     return cast(value, AutoJson)
 
 
 def _is_json_type(python_type):
-    return issubclass(python_type, (list, tuple, set, dict, BaseModel))
+    if type(python_type) is type:
+        return issubclass(python_type, (list, tuple, set, dict, BaseModel))
+    else:
+        return False
+
+
+def _is_str_type(python_type):
+    if type(python_type) is type:
+        return issubclass(python_type, str)
+    else:
+        return False
 
 
 def equal_value_query(column, value, python_type=str, dialect_type='sqlite'):
     """
     `[=]` : 等于, `abc` or `[=]abc`, 等于空字符串：`[=]`
     :param column:
     :param value:
@@ -175,15 +185,15 @@
     """
     if dialect_type in ['postgresql'] and _is_json_type(python_type):
         # SELECT * FROM :table_name WHERE EXISTS
         # (SELECT count(*) FROM jsonb_array_elements_text(:column_name) WHERE value like '%2%')
         value = cast(f"%{value}%", String)
         tmp = func.jsonb_array_elements_text(column).table_valued("value")
         return exists(select(tmp).where(tmp.c.value.like(value)))
-    if _is_json_type(python_type) or isinstance(python_type, str):
+    if _is_json_type(python_type) or _is_str_type(python_type):
         value = cast(f"%{value}%", String)
         return column.like(value)
     else:
         return None
 
 
 def not_like_value_query(column, value, python_type=str, dialect_type='sqlite'):
@@ -197,15 +207,15 @@
     """
     if dialect_type in ['postgresql'] and _is_json_type(python_type):
         # SELECT * FROM :table_name WHERE NOT EXISTS
         # (SELECT count(*) FROM jsonb_array_elements_text(:column_name) WHERE value like '%2%')
         value = cast(f"%{value}%", String)
         tmp = func.jsonb_array_elements_text(column).table_valued("value")
         return not_(exists(select(tmp).where(tmp.c.value.like(value))))
-    if _is_json_type(python_type) or isinstance(python_type, str):
+    if _is_json_type(python_type) or _is_str_type(python_type):
         value = cast(f"%{value}%", String)
         return column.not_like(value)
     else:
         return None
 
 
 def in_value_query(column, value, python_type=str, dialect_type='sqlite'):
@@ -327,45 +337,45 @@
     `[^]` : 以...开头, `[^]abc`
     :param column:
     :param value:
     :param python_type:
     :param dialect_type:
     :return:
     """
-    if isinstance(python_type, str):
+    if _is_str_type(python_type):
         return column.startswith(value)
     else:
         return None
 
 
 def endswith_value_query(column, value, python_type=str, dialect_type='sqlite'):
     """
     `[$]` : 以...结尾, `[$]abc`
     :param column:
     :param value:
     :param python_type:
     :param dialect_type:
     :return:
     """
-    if isinstance(python_type, str):
+    if _is_str_type(python_type):
         return column.endswith(value)
     else:
         return None
 
 
 def regex_value_query(column, value, python_type=str, dialect_type='sqlite'):
     """
     `[$]` : 以...结尾, `[$]abc`
     :param column:
     :param value:
     :param python_type:
     :param dialect_type:
     :return:
     """
-    if isinstance(python_type, str):
+    if _is_str_type(python_type):
         return column.regexp_match(value)
     else:
         return None
 
 
 def json_contains_value_query(column, value, python_type=str, dialect_type='sqlite'):
     """
```

## fastapix/crud/_sqlalchemy.py

```diff
@@ -1,14 +1,14 @@
 # !/usr/bin/env Python3
 # -*- coding: utf-8 -*-
 # @Author   : zhangzhanqi
 # @FILE     : _sqlalchemy.py.py
 # @Time     : 2023/10/11 16:11
 import copy
-from typing import List, Dict, Any, TypeVar, Optional, Type, Tuple, Union, Mapping
+from typing import List, Dict, Any, TypeVar, Optional, Type, Tuple, Union, Mapping, Sequence
 
 from fastapi.requests import Request
 from pydantic import BaseModel
 from sqlalchemy import func, Result, Executable, Dialect
 from sqlalchemy.engine import Row
 from sqlalchemy.orm import object_session, InstrumentedAttribute
 from sqlalchemy.sql.elements import Label
@@ -83,19 +83,19 @@
         return  # pragma: no cover
 
     async def on_after_delete(
             self, objects: List[BaseModel], request: Optional[Request] = None
     ) -> None:
         return  # pragma: no cover
 
-    def _fetch_item_scalars(self, session: Session, query=None) -> List[TableModel]:
-        sel = self.get_select()
+    def _fetch_item_scalars(self, session: Session, query=None) -> Sequence[TableModel]:
+        sel = select(self.Model)
         if query is not None:
             sel = sel.filter(query)
-        return session.execute(sel).all()
+        return session.scalars(sel).all()
 
     def pyobj_to_table(self, item: BaseModel) -> TableModel:
         return self.Model(**model_dump(item))
 
     def table_to_pyobj(self, obj: Row) -> BaseModel:
         return model_validate(self.ReadModel, obj, from_attributes=True)
 
@@ -176,30 +176,30 @@
         results = results.all()
         results = [self.table_to_pyobj(r) for r in results]
         await self.on_after_read(results, request)
         return results, total
 
     def _update_items(
             self, session: Session, primary_key: List[Any], values: Dict[str, Any], query=None
-    ) -> List[TableModel]:
+    ) -> Sequence[TableModel]:
         query = query or self.pk.in_(primary_key)
         items = self._fetch_item_scalars(session, query)
         [self.update_item(item, values) for item in items]
         return items
 
     async def update_items(self, primary_key: List[Any], item: BaseModel, request: Request = None) -> List[BaseModel]:
         await self.on_before_update(primary_key, item)
         objs = await self.db.async_run_sync(
             self._update_items, primary_key, model_dump(item, exclude_unset=True), None
         )
         results = [self.table_to_pyobj(obj) for obj in objs]
         await self.on_after_update(results, request)
         return results
 
-    def _delete_items(self, session: Session, primary_key: List[Any]) -> List[TableModel]:
+    def _delete_items(self, session: Session, primary_key: List[Any]) -> Sequence[TableModel]:
         query = self.pk.in_(primary_key)
         items = self._fetch_item_scalars(session, query)
         for item in items:
             self.delete_item(item)
         return items
 
     async def delete_items(self, primary_key: List[Any], request: Request = None) -> List[BaseModel]:
```

## Comparing `fastapix_py-0.8.2.dist-info/METADATA` & `fastapix_py-0.8.3.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: fastapix-py
-Version: 0.8.2
+Version: 0.8.3
 Summary: A FastAPI plugin that quickly builds CRUD-API based on SQLAlchemy
 Project-URL: Homepage, https://gitee.com/kaiqione/fastapix
 Project-URL: Repository, https://gitee.com/kaiqione/fastapix
 Project-URL: Source, https://gitee.com/kaiqione/fastapix
 Author-email: zhangzhanqi <zzq120203@163.com>
 License-Expression: Apache-2.0
 License-File: LICENSE
```

## Comparing `fastapix_py-0.8.2.dist-info/licenses/LICENSE` & `fastapix_py-0.8.3.dist-info/licenses/LICENSE`

 * *Files identical despite different names*

## Comparing `fastapix_py-0.8.2.dist-info/RECORD` & `fastapix_py-0.8.3.dist-info/RECORD`

 * *Files 8% similar despite different names*

```diff
@@ -1,22 +1,22 @@
-fastapix/__init__.py,sha256=nuno3TuuL80oSSKsorp_Yy1tfjLRnBaE6dqjam5aj6Y,638
+fastapix/__init__.py,sha256=HwVFhJkndI_zxSPhFl7AG0dn8D_R-KAB5Yn6mZYFkEU,638
 fastapix/__main__.py,sha256=qgNubHbROxqYWp6jEgD-uhczpvt7d8MEpEA1VPr0UVw,196
 fastapix/exceptions.py,sha256=nVVh2-gWqzcHrNGfyU_lHN-EG2MHv3dfPbmIZwAiiHM,425
 fastapix/handlers.py,sha256=r7thRDs4GylxwN0kNMxNS0r4p0IlmAvfLO_mpKvlL1Q,2321
 fastapix/innerclient.py,sha256=39hdDGWP1C7KKbYZ-6X4RIeRBJCsDBctoLHbBvLF4Kc,224
 fastapix/main.py,sha256=JUgonmAqrOjeqHtXRuNQm20anb04nbmUEqcVpD1IXh0,15404
 fastapix/responses.py,sha256=JrMiyT-wk-8iUCaixsU5xYTCz4dGPJw8Jr4HdYcJYV8,2198
 fastapix/common/__init__.py,sha256=3PwrW-AbN6xjeONyF0W-qtQt4Zi-qx4g_Xeb4TGCCR8,134
 fastapix/common/json.py,sha256=29H7HFls6Xrea04pi1h1oB9xld2HX3ryMBTgV0A8cgQ,797
 fastapix/common/pydantic.py,sha256=00IZvlymMW5y-7xnoL-g9aBbDw9_p63-DsQjzu8pl1U,18913
 fastapix/crud/__init__.py,sha256=kCq6wsUBEC_Q4QZjw29T56eQiIUcp4sqa6rZDaOk7Wg,301
 fastapix/crud/_models.py,sha256=PvC--OTxLR7QdYwhI0j_n3iuGNjp4-gN6C26mf-xXTA,9912
 fastapix/crud/_router.py,sha256=o3Hpmcqn8Az3Q3gPAOBJ-umdLvIgaBpWTB73qAYcegA,8563
-fastapix/crud/_selecter.py,sha256=TzmiAaheJkunJAhWenp3coC-X-8JneWWrz4xke8kjf8,18757
-fastapix/crud/_sqlalchemy.py,sha256=IWqsWxRMoxC0VcvMzRgWOPB7O54XVdFBAsmhIUiKS6s,8896
+fastapix/crud/_selecter.py,sha256=gm-IZFShm7uD3bMSNFgxIiyVigTn-fxnh1b26_xK6zc,18953
+fastapix/crud/_sqlalchemy.py,sha256=iYSR0fGpI0z5J40Exj7b2t3jGlnc29CSok7BEw36VfE,8919
 fastapix/crud/_sqlmodel.py,sha256=ZEST8ukFMwKLkefPbnqCP9sLG9Q1AcZj6ajltfJHqzU,22466
 fastapix/crud/_sqltypes.py,sha256=-BuSay8J2l-o7i4WxhuAnmj6xFjCTp3cg4sGVbFdLvA,532
 fastapix/crud/mixins/__init__.py,sha256=P2bXpeeZwEYYis3Zu2jclRTI074nut9cwZbEmR5he7M,180
 fastapix/crud/mixins/_typing.py,sha256=PJRNjdZ-aHN4dPBAYG_FEHc6WfEKIWh_1ylkuWiDce8,795
 fastapix/crud/mixins/models.py,sha256=l2PgYBcgkk2LCRR9KvTl0JBa7O0uC2tvCzqL2YC0CoI,1706
 fastapix/logging/__init__.py,sha256=5OjGpSsJikT0iMv5cZAg25U8mCkA3Cyc1UXhwHvwFmc,1248
 fastapix/logging/handlers.py,sha256=_1-ETIXtlgTtK_VzxS2y5e7qvZ-ykEtsXPoDgLWaoDo,805
@@ -29,11 +29,11 @@
 fastapix/offline/static/openapi/swagger-ui.css,sha256=zykFcQhm-6uyEM0PqBNr-zG1hJhT2vsM62dusHHqHKc,150947
 fastapix/offline/static/openapi/swagger-ui.css.map,sha256=GgsE41JXzVK1xNz-Wsi-VK-8axxLKhIK2_L2d1BGPRo,260489
 fastapix/sso/__init__.py,sha256=vpy4EQeIvvq2NkHDLjMFDUgMxbv__9XZPw762hHGglM,134
 fastapix/sso/_client.py,sha256=Vm4qDeAts4-ndm4oFisAmaDFAdXjmTNzRea4kYRvIOc,3168
 fastapix/sso/cas.py,sha256=LWPdmWEMnTIM4Wa982VeUyZ3qv0oQbUdeT48aUXMK2o,1297
 fastapix/sso/extend/__init__.py,sha256=0dhq1dhGYhSjKZBOxlLJooGY-A4g8RvRpI3Un2PoQKk,163
 fastapix/sso/extend/casdoor.py,sha256=X5ELgP2EgOqFaTlp1hcWw8ksfmT8AqUrCF6mYsNJI28,1428
-fastapix_py-0.8.2.dist-info/METADATA,sha256=APbOqEWK1GBbTeMBB-z056VlslxiaTEvIqdIWmHhBy4,3907
-fastapix_py-0.8.2.dist-info/WHEEL,sha256=mRYSEL3Ih6g5a_CVMIcwiF__0Ae4_gLYh01YFNwiq1k,87
-fastapix_py-0.8.2.dist-info/licenses/LICENSE,sha256=HrhfyXIkWY2tGFK11kg7vPCqhgh5DcxleloqdhrpyMY,11558
-fastapix_py-0.8.2.dist-info/RECORD,,
+fastapix_py-0.8.3.dist-info/METADATA,sha256=BiVVW-0rti5r_bs9CDJvr7EPTQgYAVDBO1DmuXAaJaw,3907
+fastapix_py-0.8.3.dist-info/WHEEL,sha256=mRYSEL3Ih6g5a_CVMIcwiF__0Ae4_gLYh01YFNwiq1k,87
+fastapix_py-0.8.3.dist-info/licenses/LICENSE,sha256=HrhfyXIkWY2tGFK11kg7vPCqhgh5DcxleloqdhrpyMY,11558
+fastapix_py-0.8.3.dist-info/RECORD,,
```

