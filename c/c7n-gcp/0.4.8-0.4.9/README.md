# Comparing `tmp/c7n_gcp-0.4.8-py3-none-any.whl.zip` & `tmp/c7n_gcp-0.4.9-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,15 +1,15 @@
-Zip file size: 69387 bytes, number of entries: 46
+Zip file size: 69574 bytes, number of entries: 46
 -rw-rw-r--  2.0 unx       81 b- defN 20-Nov-17 16:47 c7n_gcp/__init__.py
 -rw-rw-r--  2.0 unx    17672 b- defN 20-Nov-17 16:47 c7n_gcp/client.py
 -rw-rw-r--  2.0 unx      470 b- defN 20-Nov-17 16:47 c7n_gcp/entry.py
 -rw-rw-r--  2.0 unx     1622 b- defN 20-Nov-17 16:47 c7n_gcp/handler.py
--rw-rw-r--  2.0 unx    24489 b- defN 20-Nov-17 16:47 c7n_gcp/mu.py
+-rw-rw-r--  2.0 unx    24607 b- defN 21-Jan-11 16:47 c7n_gcp/mu.py
 -rw-rw-r--  2.0 unx     6276 b- defN 20-Nov-17 16:47 c7n_gcp/output.py
--rw-rw-r--  2.0 unx     6026 b- defN 20-Nov-17 16:47 c7n_gcp/policy.py
+-rw-rw-r--  2.0 unx     6025 b- defN 21-Jan-11 16:47 c7n_gcp/policy.py
 -rw-rw-r--  2.0 unx      844 b- defN 20-Nov-17 16:47 c7n_gcp/provider.py
 -rw-rw-r--  2.0 unx    14009 b- defN 20-Nov-17 16:47 c7n_gcp/query.py
 -rw-rw-r--  2.0 unx      270 b- defN 20-Nov-17 16:47 c7n_gcp/actions/__init__.py
 -rw-rw-r--  2.0 unx     3618 b- defN 20-Nov-17 16:47 c7n_gcp/actions/core.py
 -rw-rw-r--  2.0 unx     7873 b- defN 20-Nov-17 16:47 c7n_gcp/actions/cscc.py
 -rw-rw-r--  2.0 unx    11155 b- defN 20-Nov-17 16:47 c7n_gcp/actions/iampolicy.py
 -rw-rw-r--  2.0 unx     6591 b- defN 20-Nov-17 16:47 c7n_gcp/actions/labels.py
@@ -37,12 +37,12 @@
 -rw-rw-r--  2.0 unx     5793 b- defN 20-Nov-17 16:47 c7n_gcp/resources/resource_map.py
 -rw-rw-r--  2.0 unx     9688 b- defN 20-Nov-17 16:47 c7n_gcp/resources/resourcemanager.py
 -rw-rw-r--  2.0 unx     2539 b- defN 20-Dec-14 15:57 c7n_gcp/resources/service.py
 -rw-rw-r--  2.0 unx      770 b- defN 20-Nov-17 16:47 c7n_gcp/resources/source.py
 -rw-rw-r--  2.0 unx     5753 b- defN 20-Nov-17 16:47 c7n_gcp/resources/spanner.py
 -rw-rw-r--  2.0 unx     6535 b- defN 20-Nov-17 16:47 c7n_gcp/resources/sql.py
 -rw-rw-r--  2.0 unx     2393 b- defN 20-Nov-17 16:47 c7n_gcp/resources/storage.py
--rw-rw-r--  2.0 unx     4317 b- defN 20-Dec-14 16:37 c7n_gcp-0.4.8.dist-info/METADATA
--rw-rw-r--  2.0 unx       92 b- defN 20-Dec-14 16:37 c7n_gcp-0.4.8.dist-info/WHEEL
--rw-rw-r--  2.0 unx        8 b- defN 20-Dec-14 16:37 c7n_gcp-0.4.8.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     3756 b- defN 20-Dec-14 16:37 c7n_gcp-0.4.8.dist-info/RECORD
-46 files, 236930 bytes uncompressed, 63471 bytes compressed:  73.2%
+-rw-rw-r--  2.0 unx     4746 b- defN 21-Jan-11 16:55 c7n_gcp-0.4.9.dist-info/METADATA
+-rw-rw-r--  2.0 unx       92 b- defN 21-Jan-11 16:55 c7n_gcp-0.4.9.dist-info/WHEEL
+-rw-rw-r--  2.0 unx        8 b- defN 21-Jan-11 16:55 c7n_gcp-0.4.9.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     3756 b- defN 21-Jan-11 16:55 c7n_gcp-0.4.9.dist-info/RECORD
+46 files, 237476 bytes uncompressed, 63658 bytes compressed:  73.2%
```

## zipnote {}

```diff
@@ -120,20 +120,20 @@
 
 Filename: c7n_gcp/resources/sql.py
 Comment: 
 
 Filename: c7n_gcp/resources/storage.py
 Comment: 
 
-Filename: c7n_gcp-0.4.8.dist-info/METADATA
+Filename: c7n_gcp-0.4.9.dist-info/METADATA
 Comment: 
 
-Filename: c7n_gcp-0.4.8.dist-info/WHEEL
+Filename: c7n_gcp-0.4.9.dist-info/WHEEL
 Comment: 
 
-Filename: c7n_gcp-0.4.8.dist-info/top_level.txt
+Filename: c7n_gcp-0.4.9.dist-info/top_level.txt
 Comment: 
 
-Filename: c7n_gcp-0.4.8.dist-info/RECORD
+Filename: c7n_gcp-0.4.9.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## c7n_gcp/mu.py

```diff
@@ -1,10 +1,11 @@
 # Copyright The Cloud Custodian Authors.
 # SPDX-License-Identifier: Apache-2.0
 
+import base64
 from collections import namedtuple
 import json
 import logging
 import hashlib
 
 from c7n_gcp.client import errors
 from c7n.mu import generate_requirements, get_exec_options, custodian_archive as base_archive
@@ -466,15 +467,15 @@
             policy.setdefault(
                 'bindings', {'members': [publisher], 'role': 'roles/pubsub.publisher'})
         else:
             found['members'].append(publisher)
 
         client.execute_command('setIamPolicy', {'resource': topic, 'body': {'policy': policy}})
 
-    def add(self):
+    def add(self, func):
         self.ensure_topic()
 
     def remove(self):
         if not self.data.get('topic').startswith(self.prefix):
             return
         client = self.session.client('topic', 'v1', 'projects.topics')
         client.execute_command('delete', {'topic': self.get_topic_param()})
@@ -586,14 +587,15 @@
                     self.region,
                     self.session.get_default_project(),
                     func.name)
             }
         elif self.target_type == 'pubsub':
             job['pubsubTarget'] = {
                 'topicName': target.get_topic_param(),
+                'data': base64.b64encode("{\"schedule\": true}".encode('utf-8')).decode('utf-8'),
             }
         return job
 
 
 LogInfo = namedtuple('LogInfo', 'name scope_type scope_id id')
```

## c7n_gcp/policy.py

```diff
@@ -60,15 +60,15 @@
     case you want to change that, use the cli ``--region`` flag.
     """
 
     schema = type_schema(
         'gcp-periodic',
         rinherit=FunctionMode.schema,
         required=['schedule'],
-        **{'trigger-type': {'enum': ['http', 'pubsub']},
+        **{'target-type': {'enum': ['http', 'pubsub']},
            'tz': {'type': 'string'},
            'schedule': {'type': 'string'}})
 
     def validate(self):
         mode = self.policy.data['mode']
         if 'tz' in mode:
             error = PolicyValidationError(
```

## Comparing `c7n_gcp-0.4.8.dist-info/METADATA` & `c7n_gcp-0.4.9.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,29 +1,28 @@
 Metadata-Version: 2.1
 Name: c7n-gcp
-Version: 0.4.8
+Version: 0.4.9
 Summary: Cloud Custodian - Google Cloud Provider
 Home-page: https://cloudcustodian.io
 Author: Cloud Custodian Project
 License: UNKNOWN
 Platform: UNKNOWN
 Requires-Python: >=3.6,<4.0
 Description-Content-Type: text/markdown
 Requires-Dist: argcomplete (==1.12.2)
 Requires-Dist: attrs (==20.3.0)
-Requires-Dist: boto3 (==1.16.32)
-Requires-Dist: botocore (==1.19.32)
-Requires-Dist: c7n (==0.9.8)
+Requires-Dist: boto3 (==1.16.42)
+Requires-Dist: botocore (==1.19.42)
+Requires-Dist: c7n (==0.9.10)
 Requires-Dist: certifi (==2020.12.5)
 Requires-Dist: cffi (==1.14.4)
-Requires-Dist: chardet (==3.0.4)
 Requires-Dist: google-auth-httplib2 (==0.0.4)
 Requires-Dist: grpcio (==1.34.0)
 Requires-Dist: httplib2 (==0.18.1)
-Requires-Dist: importlib-metadata (==1.7.0)
+Requires-Dist: importlib-metadata (==3.3.0)
 Requires-Dist: jmespath (==0.10.0)
 Requires-Dist: jsonpickle (==1.3)
 Requires-Dist: jsonschema (==3.2.0)
 Requires-Dist: protobuf (==3.14.0)
 Requires-Dist: pyasn1-modules (==0.2.8)
 Requires-Dist: pyasn1 (==0.4.8)
 Requires-Dist: pyrsistent (==0.17.3)
@@ -31,34 +30,36 @@
 Requires-Dist: pytz (==2020.4)
 Requires-Dist: pyyaml (==5.3.1)
 Requires-Dist: ratelimiter (==1.2.0.post0)
 Requires-Dist: retrying (==1.3.3)
 Requires-Dist: s3transfer (==0.3.3)
 Requires-Dist: six (==1.15.0)
 Requires-Dist: tabulate (==0.8.7)
+Requires-Dist: typing-extensions (==3.7.4.3)
 Requires-Dist: urllib3 (==1.26.2)
 Requires-Dist: zipp (==3.4.0)
 Requires-Dist: six (==1.15.0) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.3.0"
-Requires-Dist: google-api-core (==1.23.0) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.4.0"
 Requires-Dist: google-api-python-client (==1.12.8) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.4.0"
-Requires-Dist: google-auth (==1.23.0) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.4.0"
-Requires-Dist: google-cloud-core (==1.4.4) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.4.0"
 Requires-Dist: google-cloud-logging (==1.15.1) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.4.0"
 Requires-Dist: google-cloud-monitoring (==0.34.0) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.4.0"
 Requires-Dist: googleapis-common-protos (==1.52.0) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.4.0"
 Requires-Dist: idna (==2.10) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.4.0"
 Requires-Dist: pycparser (==2.20) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.4.0"
 Requires-Dist: uritemplate (==3.0.1) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.4.0"
-Requires-Dist: google-resumable-media (==1.1.0) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.5.0"
-Requires-Dist: requests (==2.25.0) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.5.0"
+Requires-Dist: chardet (==4.0.0) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.5.0"
+Requires-Dist: requests (==2.25.1) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.5.0"
 Requires-Dist: urllib3 (==1.26.2) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.5.0" and python_version < "4"
-Requires-Dist: google-cloud-storage (==1.33.0) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.6.0"
-Requires-Dist: google-crc32c (==1.0.0) ; python_version >= "3.5"
+Requires-Dist: google-api-core (==1.24.1) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.6.0"
+Requires-Dist: google-auth (==1.24.0) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.6.0"
+Requires-Dist: google-cloud-core (==1.5.0) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.6.0"
+Requires-Dist: google-cloud-storage (==1.35.0) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.6.0"
+Requires-Dist: google-resumable-media (==1.2.0) ; python_version >= "2.7" and python_full_version < "3.0.0" or python_full_version >= "3.6.0"
 Requires-Dist: rsa (==4.6) ; python_version >= "3.5" and python_version < "4"
-Requires-Dist: cachetools (==4.1.1) ; python_version >= "3.5" and python_version < "4.0"
+Requires-Dist: cachetools (==4.2.0) ; python_version >= "3.5" and python_version < "4.0"
+Requires-Dist: google-crc32c (==1.1.0) ; python_version >= "3.6"
 
 # Custodian GCP Support
 
 Status - Alpha
 
 # Features
 
@@ -83,10 +84,18 @@
 The recommended authentication form for production usage is to create a service account and
 credentials, which will be picked up via by the custodian cli via setting the
 *GOOGLE_APPLICATION_CREDENTIALS* environment variable.
 
 
 # Serverless
 
-Custodian supports both periodic and api call events for serverless policy execution.
+Custodian supports both periodic and api call events for serverless
+policy execution.
+
+GCP Cloud Functions require cloudbuild api be enabled on the project
+the functions are deployed to.
+
+Periodic execution mode also requires cloudscheduler api be enabled on
+a project. Cloudscheduler usage also requires an app engine instance
+in the same region as the function deployment.
```

## Comparing `c7n_gcp-0.4.8.dist-info/RECORD` & `c7n_gcp-0.4.9.dist-info/RECORD`

 * *Files 6% similar despite different names*

```diff
@@ -1,14 +1,14 @@
 c7n_gcp/__init__.py,sha256=047jWuqQJ9y8E890HQc54IOBixoLTr-X2Y-HLjhF7zs,81
 c7n_gcp/client.py,sha256=HJefZkpJVX84lL7WjcxQAZUJcqNhdJ-oH8axJG57th8,17672
 c7n_gcp/entry.py,sha256=2OJvs82k_xRJts8pGsW5wsjMVguHnUXaRshrvBQ66J4,470
 c7n_gcp/handler.py,sha256=oi0L122lh2w8uWrptnZuokEY0DzftwBU7rrsAklBoHI,1622
-c7n_gcp/mu.py,sha256=Db737caicj1PcsWY1LYk_5i_M_VIi4tw7Ugp_3DxwbY,24489
+c7n_gcp/mu.py,sha256=rSLE2vz4hsers9SWW96Yk1LJe5gZVbDHk6OlFw7SGSE,24607
 c7n_gcp/output.py,sha256=7m-tw811CtHR6-Ze2VQiIYrODIj79GI8Fr432ISJndM,6276
-c7n_gcp/policy.py,sha256=sJZiNl2ZuijhN8PIm11kG5IDZihBakNLQDV5lu6GpQs,6026
+c7n_gcp/policy.py,sha256=t-Dp0BE_dMjZFdNUJVy8GaAOpNlmcaG2tvKba28ExPc,6025
 c7n_gcp/provider.py,sha256=lbhj5lzAYiqfsjbsm68lDQeTcZHRxMdDiY6gZ2JmZgw,844
 c7n_gcp/query.py,sha256=d0G8KRSh9hN4rpOR4_TYSPH5tsNBASEbw4mF0XGqWKM,14009
 c7n_gcp/actions/__init__.py,sha256=8i9zFfTLDhPS9XBKtMLnLhQ_TAzWXYUTANLiE148dvM,270
 c7n_gcp/actions/core.py,sha256=Zu9ExHtYo6MXDOZN24CrITlMKP9ieHjppocgdIQRE6k,3618
 c7n_gcp/actions/cscc.py,sha256=UZUgexeyiEhCFcj-RCer813ufqJ0kZum3MAObr5Unm0,7873
 c7n_gcp/actions/iampolicy.py,sha256=jQyrbp5GFajmrIGyo_z2Cl2HDm8BA92MJRxgzPEJhco,11155
 c7n_gcp/actions/labels.py,sha256=8x4usTCGaibC0dJWdbFvG3lfwGHzkTdyMrVK37St1H4,6591
@@ -36,11 +36,11 @@
 c7n_gcp/resources/resource_map.py,sha256=dhFouGvWEUOkpEj-kvb4TNwOaHRAisDIL-D_GeNw0-4,5793
 c7n_gcp/resources/resourcemanager.py,sha256=w3YBxzgKduV9WdaxLxRDfWBZKslusgTQqgyxTXKjsks,9688
 c7n_gcp/resources/service.py,sha256=7I910KtuL8LBsa8POpnJG_Kw9W2YjJjudTDhwVVHTUo,2539
 c7n_gcp/resources/source.py,sha256=-BJh6s7E3gzFD9Xcbj-E59-3m1zN51L-q9GKhLvlxFQ,770
 c7n_gcp/resources/spanner.py,sha256=kCH-5LiQYtlECxtQkFwo8tFlN4ylPdP1EPfo_hNSDw0,5753
 c7n_gcp/resources/sql.py,sha256=vjNCcBC3Rr79n8qMtKkoL2JNBGug9UXxFSyJgNfOVVE,6535
 c7n_gcp/resources/storage.py,sha256=aQPsU5e_xBeOz8EZaBrWnvGHrISmTLYedxvPqNrskFw,2393
-c7n_gcp-0.4.8.dist-info/METADATA,sha256=6fvxh6puB5Eolxa-TvbUp5QdIylKU7RNi7xeVr5hBCs,4317
-c7n_gcp-0.4.8.dist-info/WHEEL,sha256=OqRkF0eY5GHssMorFjlbTIq072vpHpF60fIQA6lS9xA,92
-c7n_gcp-0.4.8.dist-info/top_level.txt,sha256=ksZvoD-N3NLgTUMaNxLNDaZwSUDxfh49jH_Q1EJUlh4,8
-c7n_gcp-0.4.8.dist-info/RECORD,,
+c7n_gcp-0.4.9.dist-info/METADATA,sha256=OPHhPhonx5CQGmxg0z6D5FSavkkUJcfyDRHhXEUMPoI,4746
+c7n_gcp-0.4.9.dist-info/WHEEL,sha256=OqRkF0eY5GHssMorFjlbTIq072vpHpF60fIQA6lS9xA,92
+c7n_gcp-0.4.9.dist-info/top_level.txt,sha256=ksZvoD-N3NLgTUMaNxLNDaZwSUDxfh49jH_Q1EJUlh4,8
+c7n_gcp-0.4.9.dist-info/RECORD,,
```

